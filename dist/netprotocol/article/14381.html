<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>课后思考题 | 趣谈网络协议</title>
    <meta name="description" content="Talking about Network Protocol">
    <link rel="icon" href="/netprotocol/logo.png">
    
    <link rel="preload" href="/netprotocol/assets/css/0.styles.8ed81d4f.css" as="style"><link rel="preload" href="/netprotocol/assets/js/app.339f6ec8.js" as="script"><link rel="preload" href="/netprotocol/assets/js/29.0ab6db51.js" as="script"><link rel="prefetch" href="/netprotocol/assets/js/10.b137334e.js"><link rel="prefetch" href="/netprotocol/assets/js/11.f81a1afe.js"><link rel="prefetch" href="/netprotocol/assets/js/12.a3d3f02e.js"><link rel="prefetch" href="/netprotocol/assets/js/13.6f45434d.js"><link rel="prefetch" href="/netprotocol/assets/js/14.4373e971.js"><link rel="prefetch" href="/netprotocol/assets/js/15.bba6998c.js"><link rel="prefetch" href="/netprotocol/assets/js/16.fda5f416.js"><link rel="prefetch" href="/netprotocol/assets/js/17.8b2ce630.js"><link rel="prefetch" href="/netprotocol/assets/js/18.39838a6e.js"><link rel="prefetch" href="/netprotocol/assets/js/19.ced40dbf.js"><link rel="prefetch" href="/netprotocol/assets/js/2.5e23b1e3.js"><link rel="prefetch" href="/netprotocol/assets/js/20.dc1009fb.js"><link rel="prefetch" href="/netprotocol/assets/js/21.18ac33b5.js"><link rel="prefetch" href="/netprotocol/assets/js/22.f92681cb.js"><link rel="prefetch" href="/netprotocol/assets/js/23.167adbf1.js"><link rel="prefetch" href="/netprotocol/assets/js/24.8900bbcf.js"><link rel="prefetch" href="/netprotocol/assets/js/25.330a47bc.js"><link rel="prefetch" href="/netprotocol/assets/js/26.ee198c03.js"><link rel="prefetch" href="/netprotocol/assets/js/27.49077d84.js"><link rel="prefetch" href="/netprotocol/assets/js/28.969912e2.js"><link rel="prefetch" href="/netprotocol/assets/js/3.7da37368.js"><link rel="prefetch" href="/netprotocol/assets/js/30.f0f9e81e.js"><link rel="prefetch" href="/netprotocol/assets/js/31.b23a44cb.js"><link rel="prefetch" href="/netprotocol/assets/js/32.60bfb2fa.js"><link rel="prefetch" href="/netprotocol/assets/js/33.5f11c77a.js"><link rel="prefetch" href="/netprotocol/assets/js/34.89bbb6bb.js"><link rel="prefetch" href="/netprotocol/assets/js/35.1dd49070.js"><link rel="prefetch" href="/netprotocol/assets/js/36.f3bf019a.js"><link rel="prefetch" href="/netprotocol/assets/js/37.25799f73.js"><link rel="prefetch" href="/netprotocol/assets/js/38.3008dfdf.js"><link rel="prefetch" href="/netprotocol/assets/js/39.c71d98ea.js"><link rel="prefetch" href="/netprotocol/assets/js/4.a80811a8.js"><link rel="prefetch" href="/netprotocol/assets/js/40.659ae002.js"><link rel="prefetch" href="/netprotocol/assets/js/41.e8d258e6.js"><link rel="prefetch" href="/netprotocol/assets/js/42.97402baf.js"><link rel="prefetch" href="/netprotocol/assets/js/43.457f305d.js"><link rel="prefetch" href="/netprotocol/assets/js/44.6c2906f4.js"><link rel="prefetch" href="/netprotocol/assets/js/45.dfdf5a0e.js"><link rel="prefetch" href="/netprotocol/assets/js/46.8ead4a08.js"><link rel="prefetch" href="/netprotocol/assets/js/47.42ec58e7.js"><link rel="prefetch" href="/netprotocol/assets/js/48.c2d6747a.js"><link rel="prefetch" href="/netprotocol/assets/js/49.678b4eba.js"><link rel="prefetch" href="/netprotocol/assets/js/5.55ab3fc9.js"><link rel="prefetch" href="/netprotocol/assets/js/50.f1ad00b4.js"><link rel="prefetch" href="/netprotocol/assets/js/51.aa8a0c2d.js"><link rel="prefetch" href="/netprotocol/assets/js/52.ea53ee59.js"><link rel="prefetch" href="/netprotocol/assets/js/53.66bb194f.js"><link rel="prefetch" href="/netprotocol/assets/js/54.15d306c1.js"><link rel="prefetch" href="/netprotocol/assets/js/6.aeaee4ea.js"><link rel="prefetch" href="/netprotocol/assets/js/7.85695bf5.js"><link rel="prefetch" href="/netprotocol/assets/js/8.544243b8.js"><link rel="prefetch" href="/netprotocol/assets/js/9.4618c319.js">
    <link rel="stylesheet" href="/netprotocol/assets/css/0.styles.8ed81d4f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/netprotocol/" class="home-link router-link-active"><!----> <span class="site-name">趣谈网络协议</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/netprotocol/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他专栏</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/frontend/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  重学前端
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/ds/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  数据结构与算法之美
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/jvm/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入拆解 Java 虚拟机
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/air/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  左耳听风
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/blockchain/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入浅出区块链
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/webyck/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端面试之道
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/webinter/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Web 前端面试指南与高频考题解析
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/chrome/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  你不知道的 Chrome 调试技巧
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/canvas/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  如何使用 Canvas 制作出炫酷的网页背景特效
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/netprotocol/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他专栏</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/frontend/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  重学前端
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/ds/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  数据结构与算法之美
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/jvm/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入拆解 Java 虚拟机
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/air/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  左耳听风
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/blockchain/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入浅出区块链
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/webyck/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端面试之道
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/webinter/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Web 前端面试指南与高频考题解析
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/chrome/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  你不知道的 Chrome 调试技巧
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://doc.mcust.cn/canvas/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  如何使用 Canvas 制作出炫酷的网页背景特效
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/netprotocol/article/7398.html" class="sidebar-link">开篇词 | 想成为技术牛人？先搞定网络协议！</a></li><li><a href="/netprotocol/article/7581.html" class="sidebar-link">第1讲 | 为什么要学习网络协议？</a></li><li><a href="/netprotocol/article/7724.html" class="sidebar-link">第2讲 | 网络分层的真实含义是什么？</a></li><li><a href="/netprotocol/article/7772.html" class="sidebar-link">第3讲 | ifconfig：最熟悉又陌生的命令行</a></li><li><a href="/netprotocol/article/8015.html" class="sidebar-link">第4讲 | DHCP与PXE：IP是怎么来的，又是怎么没的？</a></li><li><a href="/netprotocol/article/8094.html" class="sidebar-link">第5讲 | 从物理层到MAC层：如何在宿舍里自己组网玩联机游戏？</a></li><li><a href="/netprotocol/article/8386.html" class="sidebar-link">第6讲 | 交换机与VLAN：办公室太复杂，我要回学校</a></li><li><a href="/netprotocol/article/8445.html" class="sidebar-link">第7讲 | ICMP与ping：投石问路的侦察兵</a></li><li><a href="/netprotocol/article/8590.html" class="sidebar-link">第8讲 | 世界这么大，我想出网关：欧洲十国游与玄奘西行</a></li><li><a href="/netprotocol/article/8729.html" class="sidebar-link">第9讲 | 路由协议：西出网关无故人，敢问路在何方</a></li><li><a href="/netprotocol/article/8924.html" class="sidebar-link">第10讲 | UDP协议：因性善而简单，难免碰到“城会玩”</a></li><li><a href="/netprotocol/article/8975.html" class="sidebar-link">第11讲 | TCP协议（上）：因性恶而复杂，先恶后善反轻松</a></li><li><a href="/netprotocol/article/9141.html" class="sidebar-link">第12讲 | TCP协议（下）：西行必定多妖孽，恒心智慧消磨难</a></li><li><a href="/netprotocol/article/9293.html" class="sidebar-link">第13讲 | 套接字Socket：Talk is cheap, show me the code</a></li><li><a href="/netprotocol/article/9410.html" class="sidebar-link">第14讲 | HTTP协议：看个新闻原来这么麻烦</a></li><li><a href="/netprotocol/article/9492.html" class="sidebar-link">第15讲 | HTTPS协议：点外卖的过程原来这么复杂</a></li><li><a href="/netprotocol/article/9688.html" class="sidebar-link">第16讲 | 流媒体协议：如何在直播里看到美女帅哥？</a></li><li><a href="/netprotocol/article/9707.html" class="sidebar-link">第17讲 | P2P协议：我下小电影，99%急死你</a></li><li><a href="/netprotocol/article/9895.html" class="sidebar-link">第18讲 | DNS协议：网络世界的地址簿</a></li><li><a href="/netprotocol/article/9938.html" class="sidebar-link">第19讲 | HTTPDNS：网络世界的地址簿也会指错路</a></li><li><a href="/netprotocol/article/10085.html" class="sidebar-link">第20讲 | CDN：你去小卖部取过快递么？</a></li><li><a href="/netprotocol/article/10098.html" class="sidebar-link">第21讲 | 数据中心：我是开发商，自己拿地盖别墅</a></li><li><a href="/netprotocol/article/10386.html" class="sidebar-link">第22讲 | VPN：朝中有人好做官</a></li><li><a href="/netprotocol/article/10534.html" class="sidebar-link">第23讲 | 移动网络：去巴塞罗那，手机也上不了脸书</a></li><li><a href="/netprotocol/article/10742.html" class="sidebar-link">第24讲 | 云中网络：自己拿地成本高，购买公寓更灵活</a></li><li><a href="/netprotocol/article/10755.html" class="sidebar-link">第25讲 | 软件定义网络：共享基础设施的小区物业管理办法</a></li><li><a href="/netprotocol/article/10978.html" class="sidebar-link">第26讲 | 云中的网络安全：虽然不是土豪，也需要基本安全和保障</a></li><li><a href="/netprotocol/article/10994.html" class="sidebar-link">第27讲 | 云中的网络QoS：邻居疯狂下电影，我该怎么办？</a></li><li><a href="/netprotocol/article/11324.html" class="sidebar-link">第28讲 | 云中网络的隔离GRE、VXLAN：虽然住一个小区，也要保护隐私</a></li><li><a href="/netprotocol/article/11465.html" class="sidebar-link">第29讲 | 容器网络：来去自由的日子，不买公寓去合租</a></li><li><a href="/netprotocol/article/11643.html" class="sidebar-link">第30讲 | 容器网络之Flannel：每人一亩三分地</a></li><li><a href="/netprotocol/article/11940.html" class="sidebar-link">第31讲 | 容器网络之Calico：为高效说出善意的谎言</a></li><li><a href="/netprotocol/article/12230.html" class="sidebar-link">第32讲 | RPC协议综述：远在天边，近在眼前</a></li><li><a href="/netprotocol/article/12388.html" class="sidebar-link">第33讲 | 基于XML的SOAP协议：不要说NBA，请说美国职业篮球联赛</a></li><li><a href="/netprotocol/article/12512.html" class="sidebar-link">第34讲 | 基于JSON的RESTful接口协议：我不关心过程，请给我结果</a></li><li><a href="/netprotocol/article/12521.html" class="sidebar-link">第35讲 | 二进制类RPC协议：还是叫NBA吧，总说全称多费劲</a></li><li><a href="/netprotocol/article/12819.html" class="sidebar-link">第36讲 | 跨语言类RPC协议：交流之前，双方先来个专业术语表</a></li><li><a href="/netprotocol/article/12991.html" class="sidebar-link">第37讲 | 知识串讲：用双十一的故事串起碎片的网络协议（上）</a></li><li><a href="/netprotocol/article/12996.html" class="sidebar-link">第38讲 | 知识串讲：用双十一的故事串起碎片的网络协议（中）</a></li><li><a href="/netprotocol/article/13099.html" class="sidebar-link">第39讲 | 知识串讲：用双十一的故事串起碎片的网络协议（下）</a></li><li><a href="/netprotocol/article/13124.html" class="sidebar-link">第40讲 | 搭建一个网络实验环境：授人以鱼不如授人以渔</a></li><li><a href="/netprotocol/article/13520.html" class="sidebar-link">协议专栏特别福利 | 答疑解惑第一期</a></li><li><a href="/netprotocol/article/13847.html" class="sidebar-link">协议专栏特别福利 | 答疑解惑第二期</a></li><li><a href="/netprotocol/article/14028.html" class="sidebar-link">协议专栏特别福利 | 答疑解惑第三期</a></li><li><a href="/netprotocol/article/14194.html" class="sidebar-link">协议专栏特别福利 | 答疑解惑第四期</a></li><li><a href="/netprotocol/article/14381.html" class="active sidebar-link">协议专栏特别福利 | 答疑解惑第五期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第22讲-vpn：朝中有人好做官》" class="sidebar-link">《第22讲 | VPN：朝中有人好做官》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第23讲-移动网络：去巴塞罗那，手机也上不了脸书》" class="sidebar-link">《第23讲 | 移动网络：去巴塞罗那，手机也上不了脸书》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第24讲-云中网络：自己拿地成本高，购买公寓更灵活》" class="sidebar-link">《第24讲 | 云中网络：自己拿地成本高，购买公寓更灵活》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第25讲-软件定义网络：共享基础设施的小区物业管理办法》" class="sidebar-link">《第25讲 | 软件定义网络：共享基础设施的小区物业管理办法》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第26讲-云中的网络安全：虽然不是土豪，也需要基本安全和保障》" class="sidebar-link">《第26讲 | 云中的网络安全：虽然不是土豪，也需要基本安全和保障》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第27讲-云中的网络qos：邻居疯狂下电影，我该怎么办？》" class="sidebar-link">《第27讲 | 云中的网络QoS：邻居疯狂下电影，我该怎么办？》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第28讲-云中网络的隔离gre、vxlan：虽然住一个小区，也要保护隐私》" class="sidebar-link">《第28讲 | 云中网络的隔离GRE、VXLAN：虽然住一个小区，也要保护隐私》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第29讲-容器网络：来去自由的日子，不买公寓去合租》" class="sidebar-link">《第29讲 | 容器网络：来去自由的日子，不买公寓去合租》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第30讲-容器网络之flannel：每人一亩三分地》" class="sidebar-link">《第30讲 | 容器网络之Flannel：每人一亩三分地》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第31讲-容器网络之calico：为高效说出善意的谎言》" class="sidebar-link">《第31讲 | 容器网络之Calico：为高效说出善意的谎言》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第32讲-rpc协议综述：远在天边，近在眼前》" class="sidebar-link">《第32讲 | RPC协议综述：远在天边，近在眼前》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第33讲-基于xml的soap协议：不要说nba，请说美国职业篮球联赛》" class="sidebar-link">《第33讲 | 基于XML的SOAP协议：不要说NBA，请说美国职业篮球联赛》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第34讲-基于json的restful接口协议：我不关心过程，请给我结果》" class="sidebar-link">《第34讲 | 基于JSON的RESTful接口协议：我不关心过程，请给我结果》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第35讲-二进制类rpc协议：还是叫nba吧，总说全称多费劲》" class="sidebar-link">《第35讲 | 二进制类RPC协议：还是叫NBA吧，总说全称多费劲》</a></li><li class="sidebar-sub-header"><a href="/netprotocol/article/14381.html#《第36讲-跨语言类rpc协议：交流之前，双方先来个专业术语表》" class="sidebar-link">《第36讲 | 跨语言类RPC协议：交流之前，双方先来个专业术语表》</a></li></ul></li><li><a href="/netprotocol/article/14384.html" class="sidebar-link">测一测 | 这些网络协议你都掌握了吗？</a></li><li><a href="/netprotocol/article/14553.html" class="sidebar-link">结束语 | 放弃完美主义，执行力就是限时限量认真完成</a></li><li><a href="/netprotocol/article/17846.html" class="sidebar-link">我是如何创作“趣谈网络协议”专栏的？</a></li><li><a href="/netprotocol/article/17862.html" class="sidebar-link">“趣谈网络协议”专栏「食用指南」</a></li></ul> </div> <div class="page"> <div class="content"><p>你好，我是刘超。</p> <p>第五期答疑涵盖第22讲至第36讲的内容。我依旧对课后思考题和留言中比较有代表性的问题作出回答。你可以点击文章名，回到对应的章节复习，也可以继续在留言区写下你的疑问，我会持续不断地解答。希望对你有帮助。</p> <h2 id="《第22讲-vpn：朝中有人好做官》"><a href="#《第22讲-vpn：朝中有人好做官》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/10386" target="_blank" rel="noopener noreferrer">《第22讲 | VPN：朝中有人好做官》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题"><a href="#课后思考题" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>当前业务的高可用性和弹性伸缩很重要，所以很多机构都会在自建私有云之外，采购公有云，你知道私有云和公有云应该如何打通吗？</p> <p><img src="https://static001.geekbang.org/resource/image/88/2b/882fbc4105dcfb68e9da055065ad0f2b.jpg" alt></p> <h3 id="留言问题"><a href="#留言问题" aria-hidden="true" class="header-anchor">#</a> 留言问题</h3> <p>DH算法会因为传输随机数被破解吗？</p> <p><img src="https://static001.geekbang.org/resource/image/59/b5/5985bcc89e863897eecb18097e8430b5.jpg" alt></p> <p>这位同学的<a href="https://mubu.com/doc/1cZYndRrAg" target="_blank" rel="noopener noreferrer">笔记<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>特别认真，让人感动。DH算法的交换材料要分公钥部分和私钥部分，公钥部分和其他非对称加密一样，都是可以传输的，所以对于安全性是没有影响的，而且传输材料远比传输原始的公钥更加安全。私钥部分是谁都不能给的，因此也是不会截获到的。</p> <h2 id="《第23讲-移动网络：去巴塞罗那，手机也上不了脸书》"><a href="#《第23讲-移动网络：去巴塞罗那，手机也上不了脸书》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/10534" target="_blank" rel="noopener noreferrer">《第23讲 | 移动网络：去巴塞罗那，手机也上不了脸书》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-2"><a href="#课后思考题-2" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>咱们上网都有套餐，有交钱多的，有交钱少的，你知道移动网络是如何控制不同优先级的用户的上网流量的吗？</p> <p>这个其实是PCRF协议进行控制的，它可以下发命令给PGW来控制上网的行为和特性。</p> <h2 id="《第24讲-云中网络：自己拿地成本高，购买公寓更灵活》"><a href="#《第24讲-云中网络：自己拿地成本高，购买公寓更灵活》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/10742" target="_blank" rel="noopener noreferrer">《第24讲 | 云中网络：自己拿地成本高，购买公寓更灵活》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-3"><a href="#课后思考题-3" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>为了直观，这一节的内容我们以桌面虚拟化系统举例。在数据中心里面，有一款著名的开源软件OpenStack，这一节讲的网络连通方式对应OpenStack中的哪些模型呢？</p> <p><img src="https://static001.geekbang.org/resource/image/dd/c2/dde85e3ca5c02dfcde75b8bb96a264c2.jpg" alt></p> <p>OpenStack的早期网络模式有Flat、Flat DHCP、VLAN，后来才有了VPC，用VXLAN和GRE进行隔离。</p> <h2 id="《第25讲-软件定义网络：共享基础设施的小区物业管理办法》"><a href="#《第25讲-软件定义网络：共享基础设施的小区物业管理办法》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/10755" target="_blank" rel="noopener noreferrer">《第25讲 | 软件定义网络：共享基础设施的小区物业管理办法》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-4"><a href="#课后思考题-4" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>在这一节中，提到了通过VIP可以通过流表在不同的机器之间实现负载均衡，你知道怎样才能做到吗？</p> <p>可以通过ovs-ofctl下发流表规则，创建group，并把端口加入group中，所有发现某个地址的包在两个端口之间进行负载均衡。</p> <pre><code>sudo ovs-ofctl -O openflow11 add-group br-lb &quot;group_id=100 type=select selection_method=dp_hash bucket=output:1 bucket=output:2&quot;
sudo ovs-ofctl -O openflow11 add-flow br-lb &quot;table=0,ip,nw_dst=192.168.2.0/24,actions=group:100&quot;
</code></pre> <h3 id="留言问题-2"><a href="#留言问题-2" aria-hidden="true" class="header-anchor">#</a> 留言问题</h3> <p>SDN控制器是什么东西？</p> <p><img src="https://static001.geekbang.org/resource/image/e5/a4/e5401b93f60da5b95fdc0e060a0a51a4.jpg" alt></p> <p>SDN控制器是一个独立的集群，主要是在管控面，因为要实现一定的高可用性。</p> <p>主流的开源控制器有OpenContrail、OpenDaylight等。当然每个网络硬件厂商都有自己的控制器，而且可以实现自己的私有协议，进行更加细粒度的控制，所以江湖一直没有办法统一。</p> <p>流表是在每一台宿主机上保存的，大小限制取决于内存，而集中存放的缺点就是下发会很慢。</p> <h2 id="《第26讲-云中的网络安全：虽然不是土豪，也需要基本安全和保障》"><a href="#《第26讲-云中的网络安全：虽然不是土豪，也需要基本安全和保障》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/10978" target="_blank" rel="noopener noreferrer">《第26讲 | 云中的网络安全：虽然不是土豪，也需要基本安全和保障》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-5"><a href="#课后思考题-5" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>这一节中重点讲了iptables的filter和nat功能，iptables还可以通过QUEUE实现负载均衡，你知道怎么做吗？</p> <p>我们可以在iptables里面添加下面的规则：</p> <pre><code>-A PREROUTING -p tcp -m set --match-set minuteman dst,dst -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j NFQUEUE --queue-balance 50:58
-A OUTPUT -p tcp -m set --match-set minuteman dst,dst -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j NFQUEUE --queue-balance 50:58
</code></pre> <p>NFQUEUE的规则表示将把包的处理权交给用户态的一个进程。–queue-balance表示会将包发给几个queue。</p> <p>libnetfilter_queue是一个用户态库，用户态进程会使用libnetfilter_queue连接到这些queue中，将包读出来，根据包的内容做决策后，再放回内核进行发送。</p> <h2 id="《第27讲-云中的网络qos：邻居疯狂下电影，我该怎么办？》"><a href="#《第27讲-云中的网络qos：邻居疯狂下电影，我该怎么办？》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/10994" target="_blank" rel="noopener noreferrer">《第27讲 | 云中的网络QoS：邻居疯狂下电影，我该怎么办？》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-6"><a href="#课后思考题-6" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>这一节中提到，入口流量其实没有办法控制，出口流量是可以很好控制的，你能想出一个控制云中的虚拟机的入口流量的方式吗？</p> <p><img src="https://static001.geekbang.org/resource/image/0a/26/0ae24cd15cda3eb8aba91666650d1526.jpg" alt></p> <p>在云平台中，我们可以限制一个租户的默认带宽，我们仍然可以配置点对点的流量控制。</p> <p>在发送方的OVS上，我们可以统计发送方虚拟机的网络统计数据，上报给管理面。在接收方的OVS上，我们同样可以收集接收方虚拟机的网络统计数据，上报给管理面。</p> <p>当流量过大的时候，我们虽然不能控制接收方的入口流量，但是我们可以在管理面下发一个策略，控制发送方的出口流量。</p> <h3 id="留言问题-3"><a href="#留言问题-3" aria-hidden="true" class="header-anchor">#</a> 留言问题</h3> <p>对于HTB借流量的情况，借出去的流量能够抢回来吗？</p> <p><img src="https://static001.geekbang.org/resource/image/ec/79/ec406e7e9502859e9b6b80c04d703979.jpg" alt></p> <p>首先，借出去的流量，当自己使用的时候，是能够抢回来的。</p> <p>有一篇著名的文章<a href="http://luxik.cdi.cz/~devik/qos/htb/manual/userg.htm" target="_blank" rel="noopener noreferrer">《HTB Linux queuing discipline manual》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里面很详细，你可以看看。</p> <p><img src="https://static001.geekbang.org/resource/image/2b/0b/2bf7de23e5bda856c606a73f66dd050b.jpg" alt></p> <p>很多人看不懂，这是一棵HTB树，有三个分支。A用户使用www访问网页，SMTP协议发送邮件，B用户不限协议。</p> <p>在时间0的时候，0、1、2都以90k的速度发送数据，也即A用户在访问网页，同时发送邮件；B也在上网，干啥都行。</p> <p>在时间3的时候，将0的发送停止，A不再访问网页了，红色的线归零，A的总速率下来了，剩余的流量按照比例分给了蓝色的和绿色的线，也即分给了A发邮件和B上网。</p> <p>在时间6的时候，将0的发送重启为90k，也即A重新开始访问网页，则蓝色和绿色的流量返还给红色的流量。</p> <p>在时间9的时候，将1的发送停止，A不再发送邮件了，绿色的流量为零，A的总速率也下来了，剩余的流量按照比例分给了蓝色和红色。</p> <p>在时间12，将1的发送恢复，A又开始发送邮件了，红色和蓝色返还流量。</p> <p>在时间15，将2的发送停止，B不再上网了，啥也不干了，蓝色流量为零，剩余的流量按照比例分给红色和绿色。</p> <p>在时间19，将1的发送停止，A不再发送邮件了，绿色的流量为零，所有的流量都归了红色，所有的带宽都用于A来访问网页。</p> <h2 id="《第28讲-云中网络的隔离gre、vxlan：虽然住一个小区，也要保护隐私》"><a href="#《第28讲-云中网络的隔离gre、vxlan：虽然住一个小区，也要保护隐私》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/11324" target="_blank" rel="noopener noreferrer">《第28讲 | 云中网络的隔离GRE、VXLAN：虽然住一个小区，也要保护隐私》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-7"><a href="#课后思考题-7" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>虽然VXLAN可以支持组播，但是如果虚拟机数目比较多，在Overlay网络里面，广播风暴问题依然会很严重，你能想到什么办法解决这个问题吗？</p> <p><img src="https://static001.geekbang.org/resource/image/c3/0e/c354402836976d9defcf67d36ba2ae0e.jpg" alt></p> <p>很多情况下，物理机可以提前知道对端虚拟机的MAC地址，因而当发起ARP请求的时候，不用广播全网，只要本地返回就可以了，在Openstack里面称为L2Population。</p> <h2 id="《第29讲-容器网络：来去自由的日子，不买公寓去合租》"><a href="#《第29讲-容器网络：来去自由的日子，不买公寓去合租》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/11465" target="_blank" rel="noopener noreferrer">《第29讲 | 容器网络：来去自由的日子，不买公寓去合租》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-8"><a href="#课后思考题-8" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>容器内的网络和物理机网络可以使用NAT的方式相互访问，如果这种方式用于部署应用，有什么问题呢？</p> <p><img src="https://static001.geekbang.org/resource/image/68/25/683db80f520ddc094817d5e780099025.jpg" alt></p> <p>_CountingStars对这个问题进行了补充。</p> <p><img src="https://static001.geekbang.org/resource/image/97/3f/978d279627a1388c54c2eb2466cd0d3f.jpg" alt></p> <p>其实就是性能损耗，随机端口占用，看不到真实IP。</p> <h2 id="《第30讲-容器网络之flannel：每人一亩三分地》"><a href="#《第30讲-容器网络之flannel：每人一亩三分地》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/11643" target="_blank" rel="noopener noreferrer">《第30讲 | 容器网络之Flannel：每人一亩三分地》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-9"><a href="#课后思考题-9" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>通过 Flannel 的网络模型可以实现容器与容器直接跨主机的互相访问，那你知道如果容器内部访问外部的服务应该怎么融合到这个网络模型中吗？</p> <p><img src="https://static001.geekbang.org/resource/image/ac/83/acb3aef79240c8707f70491604dbde83.jpg" alt></p> <p>Pod内到外部网络是通过docker引擎在iptables的POSTROUTING中的MASQUERADE规则实现的，将容器的地址伪装为node IP出去，回来时再把包nat回容器的地址。</p> <p>有的时候，我们想给外部的一个服务使用一个固定的域名，这就需要用到Kubernetes里headless service的ExternalName。我们可以将某个外部的地址赋给一个Service的名称，当容器内访问这个名字的时候，就会访问一个虚拟的IP。然后，在容器所在的节点上，由iptables规则映射到外部的IP地址。</p> <h2 id="《第31讲-容器网络之calico：为高效说出善意的谎言》"><a href="#《第31讲-容器网络之calico：为高效说出善意的谎言》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/11940" target="_blank" rel="noopener noreferrer">《第31讲 | 容器网络之Calico：为高效说出善意的谎言》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-10"><a href="#课后思考题-10" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>将Calico部署在公有云上的时候，经常会选择使用IPIP模式，你知道这是为什么吗？</p> <p>_CountingStars的回答是部分正确的。</p> <p><img src="https://static001.geekbang.org/resource/image/17/a2/1769832623a4a14e4bc79a67b3e522a2.jpg" alt></p> <p>一个原因是中间有路由，如果VPC网络是平的，但是公有云经常会有一个限制，那就是器的IP段是用户自己定义的，一旦出虚拟机的时候，云平台发现不是它分配的IP，很多情况下直接就丢弃了。如果是IPIP，出虚拟机之后，IP还是虚拟机的IP，就没有问题。</p> <h2 id="《第32讲-rpc协议综述：远在天边，近在眼前》"><a href="#《第32讲-rpc协议综述：远在天边，近在眼前》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/12230" target="_blank" rel="noopener noreferrer">《第32讲 | RPC协议综述：远在天边，近在眼前》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-11"><a href="#课后思考题-11" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>在这篇文章中，mount的过程是通过系统调用，最终调用到RPC层。一旦mount完毕之后，客户端就像写入本地文件一样写入NFS了，这个过程是如何触发RPC层的呢？</p> <p>_CountingStars的回答很有深度。</p> <p><img src="https://static001.geekbang.org/resource/image/7a/60/7ab3228c9cb73e7f0cf0b922332d1d60.jpg" alt></p> <p>是的，是通过VFS实现的。</p> <p>在讲<a href="https://time.geekbang.org/column/article/9141" target="_blank" rel="noopener noreferrer">Socket<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>那一节的时候，我们知道，在Linux里面，很多东西都是文件，因而内核中有一个打开的文件列表File list，每个打开的文件都有一项。</p> <p><img src="https://static001.geekbang.org/resource/image/60/8c/602d09290bd4f9e0183f530e9653348c.jpg" alt></p> <p>对于Socket来讲，in-core inode就是内存中的inode。对于nfs来讲，也有一个inode，这个inode里面有一个成员变量file_operations，这里面是这个文件系统的操作函数。对于nfs来讲，因为有nfs_file_read、nfs_file_write，所以在一个mount的路径中读取某个文件的时候，就会调用这两个函数，触发RPC，远程调用服务端。</p> <h2 id="《第33讲-基于xml的soap协议：不要说nba，请说美国职业篮球联赛》"><a href="#《第33讲-基于xml的soap协议：不要说nba，请说美国职业篮球联赛》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/12388" target="_blank" rel="noopener noreferrer">《第33讲 | 基于XML的SOAP协议：不要说NBA，请说美国职业篮球联赛》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-12"><a href="#课后思考题-12" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>对于HTTP协议来讲，有多种方法，但是SOAP只用了POST，这样会有什么问题吗？</p> <p><img src="https://static001.geekbang.org/resource/image/8a/19/8a889ea32a5a404c432a1102b90a4819.jpg" alt></p> <h2 id="《第34讲-基于json的restful接口协议：我不关心过程，请给我结果》"><a href="#《第34讲-基于json的restful接口协议：我不关心过程，请给我结果》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/12512" target="_blank" rel="noopener noreferrer">《第34讲 | 基于JSON的RESTful接口协议：我不关心过程，请给我结果》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-13"><a href="#课后思考题-13" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>在讨论RESTful模型的时候，举了一个库存的例子，但是这种方法有很大问题，那你知道为什么要这样设计吗？</p> <p><img src="https://static001.geekbang.org/resource/image/4a/a2/4ab1e3cb5b48a843d6dc5967cc1238a2.jpg" alt></p> <p>这个我在双十一包的例子中已经分析过了。</p> <h2 id="《第35讲-二进制类rpc协议：还是叫nba吧，总说全称多费劲》"><a href="#《第35讲-二进制类rpc协议：还是叫nba吧，总说全称多费劲》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/12521" target="_blank" rel="noopener noreferrer">《第35讲 | 二进制类RPC协议：还是叫NBA吧，总说全称多费劲》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-14"><a href="#课后思考题-14" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>对于微服务模式下的RPC框架的选择，Dubbo和SpringCloud各有优缺点，你能做个详细的对比吗？</p> <p><img src="https://static001.geekbang.org/resource/image/49/33/49d571110301eab5cf61560bfee2f333.jpg" alt></p> <h2 id="《第36讲-跨语言类rpc协议：交流之前，双方先来个专业术语表》"><a href="#《第36讲-跨语言类rpc协议：交流之前，双方先来个专业术语表》" aria-hidden="true" class="header-anchor">#</a> <a href="https://time.geekbang.org/column/article/12819" target="_blank" rel="noopener noreferrer">《第36讲 | 跨语言类RPC协议：交流之前，双方先来个专业术语表》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h3 id="课后思考题-15"><a href="#课后思考题-15" aria-hidden="true" class="header-anchor">#</a> 课后思考题</h3> <p>在讲述Service Mesh的时候，我们说了，希望Envoy能够在服务不感知的情况下，将服务之间的调用全部代理了，你知道怎么做到这一点吗？</p> <p><img src="https://static001.geekbang.org/resource/image/0b/d3/0b13bbed598d0d9b9a783d1a3fa881d3.jpg" alt></p> <p><img src="https://static001.geekbang.org/resource/image/56/f8/56e282315a2ef361aa0a8bb1cf0b38f8.jpg" alt></p> <p>iptables规则可以这样来设置：</p> <p>首先，定义的一条规则是ISTIO_REDIRECT转发链。这条链不管三七二十一，都将网络包转发给envoy的15000端口。但是一开始这条链没有被挂到iptables默认的几条链中，所以不起作用。</p> <p>接下来，在PREROUTING规则中使用这个转发链。从而，进入容器的所有流量都被先转发到envoy的15000端口。而envoy作为一个代理，已经被配置好了，将请求转发给productpage程序。</p> <p>当productpage往后端进行调用的时候，就碰到了output链。这个链会使用转发链，将所有出容器的请求都转发到envoy的15000端口。</p> <p>这样，无论是入口的流量，还是出口的流量，全部用envoy做成了“汉堡包”。envoy根据服务发现的配置，做最终的对外调用。</p> <p>这个时候，iptables规则会对从envoy出去的流量做一个特殊处理，允许它发出去，不再使用上面的output规则。</p> <hr> <p>感谢第22讲至第36讲中对内容有深度思考和提出问题的同学。我会为你们送上奖励礼券和知识图谱。（稍后运营同学会发送短信通知。）</p> <p><img src="https://static001.geekbang.org/resource/image/90/99/90874109328ea2f88d097f58dddc4e99.jpg" alt></p> <p>咱们的答疑环节暂时告一段落了，如果你在学习过程中有什么问题，欢迎你继续留言给我！</p> <p><img src="https://static001.geekbang.org/resource/image/b5/fb/b5bc14cb81d3630919fee94a512cc3fb.jpg" alt></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/netprotocol/article/14194.html" class="prev">
          协议专栏特别福利 | 答疑解惑第四期
        </a></span> <span class="next"><a href="/netprotocol/article/14384.html">
          测一测 | 这些网络协议你都掌握了吗？
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/netprotocol/assets/js/app.339f6ec8.js" defer></script><script src="/netprotocol/assets/js/29.0ab6db51.js" defer></script>
  </body>
</html>
